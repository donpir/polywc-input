<link rel="import" href="../polymer/polymer.html">

<link rel="import" href="../paper-input/paper-input-container.html">
<link rel="import" href="../iron-input/iron-input.html">

<link rel="import" href="polywc-input-listbox.html">

<!-- TEST -->
<link rel="import" href="../paper-input/paper-input.html">


<dom-module id="polywc-input-search">
    <template>
        <style>
            /*:host {


            }
            :host([hidden]) {
                display: none !important;
            }
            :host-context([dir="rtl"]) {
                float: left;
            }*/

        </style>


        <paper-input-container>
            <input id="txtInput" is="iron-input" on-keyup="_handleOnKeyUp">
            <polywc-input-listbox id="wcListbox" suggestions="[[_suggestions]]" on-click-item="_handleOnClickItem"></polywc-input-listbox>
        </paper-input-container>

        <!--<paper-input id="txtInput" on-keyup="_handleOnKeyUp"></paper-input>
        <paper-material id="lstSuggestion" elevation="1">
            <template is="dom-repeat" items="[[_suggestions]]">
                <paper-item index="[[index]]" on-click="_handleItemSelected">[[item.text]]</paper-item>
            </template>
        </paper-material>-->
    </template>
    <script>
        Polymer({
            is: 'polywc-input-search',

            properties: {
                suggestions: { type: Array },

                _suggestions:   { type: Array, value: [] }
            },

            _handleOnClickItem: function(event) {
                var item = event.detail.item;
                this.$.txtInput.value = item.text;
                this.$.wcListbox.hidden = true;
            },

            _handleOnKeyUp: function(event) {
                var searchtext = event.currentTarget.value;

                this._filter(searchtext);
                this.$.wcListbox.hidden = false;
            },

            _filter: function(keyword) {
                if (this.suggestions == null || keyword == null || keyword.trim().length == 0) {
                    this._suggestions = [];
                    return;
                }
                this._suggestions = [];

                for (var i= 0, item=null; i<this.suggestions.length && (item = this.suggestions[i]); i++) {
                    if (item.text.indexOf(keyword) !== -1)
                        this.push('_suggestions', item);
                }//EndFor.
            }

            /*,

            ready: function() {

            },

            _handleOnKeyUp: function(event) {
                var searchtext = event.currentTarget.value;

                this._filter(searchtext);
                console.log("keypresss");
            }

            _handleItemSelected: function(event) {
                var index = event.currentTarget.index;
                var item = this._suggestions[index];
                this.$.txtInput.value = item.text;
            },

            _filter: function(keyword) {
                if (this.suggestions == null || keyword == null || keyword.trim().length == 0) {
                    this._suggestions = [];
                    return;
                }
                this._suggestions = [];

                for (var i= 0, item=null; i<this.suggestions.length && (item = this.suggestions[i]); i++) {
                    if (item.text.indexOf(keyword) !== -1)
                        this.push('_suggestions', item);
                }//EndFor.
            }*/

        });
    </script>
</dom-module>